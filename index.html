<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My Notes Blog</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  <style>
    body { background-color: #f0f2f5; }
    .sidebar { min-height: 100vh; background-color: #fff; border-right: 1px solid #ddd; }
    .cursor-pointer { cursor: pointer; }
    .notification-icon { position: relative; }
    .notification-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: red;
      color: white;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 12px;
    }
    .status-box textarea {
      resize: none;
      border-radius: 10px;
    }
  </style>
</head>
<body>

  <header class="bg-primary text-white py-2 px-3 d-flex justify-content-between align-items-center shadow-sm">
    <div class="d-flex align-items-center">
      <i class="fab fa-facebook fa-2x me-2"></i>
      <strong>My Notes</strong>
    </div>
    <div class="d-flex align-items-center">
      <div class="input-group me-2">
        <input type="text" id="search" class="form-control" placeholder="Cari artikel atau tag...">
        <button class="btn btn-light" onclick="randomPost()">üé≤</button>
      </div>
      <div class="notification-icon me-3">
        <i class="fas fa-bell fa-lg"></i>
        <span class="notification-badge" id="notifCount">1</span>
      </div>
      <i class="fas fa-user-circle fa-2x"></i>
    </div>
  </header>

  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-md-2 sidebar py-4">
        <ul class="nav flex-column">
          <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-home me-2"></i>Beranda</a></li>
          <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-user-friends me-2"></i>Teman</a></li>
          <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-bookmark me-2"></i>Tersimpan</a></li>
          <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-cog me-2"></i>Pengaturan</a></li>
        </ul>
      </div>

      <!-- Main Feed -->
      <div class="col-md-7 py-4">
        <!-- Status update -->
        <div class="card mb-3 shadow-sm">
          <div class="card-body">
            <div class="d-flex">
              <i class="fas fa-user-circle fa-2x me-2"></i>
              <textarea class="form-control" placeholder="Apa yang Anda pikirkan?" rows="2"></textarea>
            </div>
            <div class="mt-2 text-end">
              <button class="btn btn-primary btn-sm">Posting</button>
            </div>
          </div>
        </div>

        <!-- Feed Posts -->
        <div id="posts"></div>
      </div>

      <!-- Right Sidebar -->
      <div class="col-md-3 py-4">
        <div class="card shadow-sm mb-3">
          <div class="card-header">Notifikasi Terbaru</div>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">üîî 1 postingan baru ditambahkan</li>
            <li class="list-group-item">‚úÖ Data berhasil dimuat</li>
          </ul>
        </div>
        <div class="card shadow-sm">
          <div class="card-header">Info</div>
          <div class="card-body">
            &copy; 2025 My Notes Blog
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="postModal" class="modal fade" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="modalTitle" class="modal-title"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p id="modalContent"></p>
          <img id="modalImage" class="img-fluid d-none" alt="Post Image">
        </div>
        <div class="modal-footer">
          <button id="likeButton" class="btn btn-outline-danger"><i class="fas fa-heart"></i> Like</button>
          <button id="dislikeButton" class="btn btn-outline-dark"><i class="fas fa-thumbs-down"></i> Dislike</button>
          <span id="likeCount" class="ms-2">0 Likes</span>
          <span id="viewCount" class="ms-2">üëÅÔ∏è 0 views</span>
          <button class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script>
    const apiUrl = "https://script.google.com/macros/s/YOUR_SCRIPT_ID_HERE/exec";
    let posts = [];

    async function fetchPosts() {
      try {
        const res = await fetch(apiUrl);
        posts = await res.json();
        renderPosts();
      } catch (e) {
        document.getElementById("posts").innerHTML = "<p class='text-danger'>Gagal memuat data.</p>";
      }
    }

    function renderPosts() {
      let html = '';
      posts.forEach((post, i) => {
        html += `
          <div class="card mb-3 shadow-sm">
            <div class="card-body">
              <h5 class="card-title cursor-pointer text-primary" onclick="openModal(${i})">${post.Judul}</h5>
              <p class="card-text">${post.Isi.slice(0, 120)}...</p>
            </div>
          </div>
        `;
      });
      document.getElementById("posts").innerHTML = html;
    }

    function openModal(index) {
      const post = posts[index];
      document.getElementById('modalTitle').innerText = post.Judul;
      document.getElementById('modalContent').innerText = post.Isi;
      if (post.Gambar) {
        document.getElementById('modalImage').src = post.Gambar;
        document.getElementById('modalImage').classList.remove('d-none');
      } else {
        document.getElementById('modalImage').classList.add('d-none');
      }
      let views = localStorage.getItem(`views_${post.Judul}`) || 0;
      views++;
      localStorage.setItem(`views_${post.Judul}`, views);
      document.getElementById('viewCount').innerText = `üëÅÔ∏è ${views} views`;

      let likeCount = localStorage.getItem(`likeCount_${post.Judul}`) || 0;
      document.getElementById('likeCount').innerText = `${likeCount} Likes`;

      document.getElementById('likeButton').onclick = () => {
        likeCount++;
        localStorage.setItem(`likeCount_${post.Judul}`, likeCount);
        document.getElementById('likeCount').innerText = `${likeCount} Likes`;
      };

      document.getElementById('dislikeButton').onclick = () => {
        alert("Terima kasih atas feedback!");
      };

      new bootstrap.Modal(document.getElementById('postModal')).show();
    }

    function randomPost() {
      if (!posts.length) return alert("Belum ada postingan!");
      openModal(Math.floor(Math.random() * posts.length));
    }

    document.getElementById('search').addEventListener('input', function () {
      const term = this.value.toLowerCase();
      const filtered = posts.filter(p => p.Judul?.toLowerCase().includes(term) || p.Tags?.toLowerCase().includes(term));
      renderFilteredPosts(filtered);
    });

    function renderFilteredPosts(data) {
      let html = '';
      data.forEach(post => {
        html += `
          <div class="card mb-3 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">${post.Judul}</h5>
              <p class="card-text">${post.Isi.slice(0, 100)}...</p>
            </div>
          </div>`;
      });
      document.getElementById('posts').innerHTML = html;
    }

    fetchPosts();
  </script>

</body>
</html>
